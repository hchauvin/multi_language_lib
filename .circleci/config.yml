version: 2
jobs:
  gcc-6:
    docker:
      - image: conanio/gcc6
    steps:
      - checkout
      - run:
          name: Build Conan package
          command: |
            sudo pip install --upgrade conan
            sudo apt-get update
            sudo apt-get install -y r-base
      - run:
          name: Third Party
          command: |
            mkdir -p third_party
            cd third_party
            rm -rf conan-vscodepropertiesgen
            git clone https://github.com/mkovalchik/conan-vscodepropertiesgen.git
            cd conan-vscodepropertiesgen
            conan export . vscodepropertiesgen/0.1@mkovalchik/stable
      # - run:
      #     name: C++
      #     command: |
      #       cd cpp
      #       mkdir -p build
      #       cd build

      #       conan install .. --build=outdated
      #       cmake .. -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug
      #       cmake --build .. --target test
      #       bin/test
      - run:
          name: R
          command: |
            cd R
            R -e "devtools::load_all(); example::str_split('hello world')"
            R -e "devtools::test()"
      - run:
          name: Python
          command: |
            cd python
            ./setup.py develop
            ./setup.py test
workflows:
  version: 2
  build_and_test:
    jobs:
      - gcc-6
